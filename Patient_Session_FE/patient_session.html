<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1.0"/>
  <title>Choose a Session – EchoVisit</title>
  <link rel="stylesheet" href="../Patient_Session_FE/patient_session.css" />
</head>
<body>
  <!-- Navbar (same as your other pages) -->
  <header>
    <nav class="navbar">
      <div class="logo-container">
        <img src="../logo/4.png" alt="EchoVisit Logo" class="logo" />
      </div>
      <ul class="nav-links">
        <li><a href="../Home_FE/home.html">HOME</a></li>
        <li><a href="#">ABOUT US</a></li>
        <li><a href="#">FEATURES</a></li>
        <li><a href="#">CONTACT</a></li>
        <li><a href="#">SIGN UP</a></li>
      </ul>
    </nav>
  </header>

  <main class="wrap">
    <h1>Welcome, Echo!</h1>
    <p class="subtitle">Choose a visit to view its summary & notes:</p>

    <section class="toolbar">
      <input id="search" type="text" placeholder="Search by provider, clinic, or notes…" />
      <div class="filters">
        <button class="chip active" data-range="all">All</button>
        <button class="chip" data-range="30">Last 30 days</button>
        <button class="chip" data-range="90">Last 90 days</button>
        <button class="chip" data-range="365">Last year</button>
      </div>
    </section>

    <section id="grid" class="grid">
      <!-- Example cards (you can server-render these) -->
      <!-- Use data-* attrs so JS can filter -->
      <article class="card" data-date="2025-08-08" data-provider="Dr. Morales" data-notes="follow up bp">
        <div class="row">
          <h3 class="title">General Checkup</h3>
          <span class="status done">Signed</span>
        </div>
        <p class="meta">Aug 8, 2025 • Dr. Gupta • NYC Health</p>
        <p class="snippet">Follow-up on blood pressure, adjusted medication dosage.</p>
        <a class="btn" href="../Patient_FE/patient.html?demo=1">View Summary</a>
      </article>

      <article class="card" data-date="2025-07-12" data-provider="Dr. Singh" data-notes="lab results">
        <div class="row">
          <h3 class="title">Lab Results Review</h3>
          <span class="status pending">Pending</span>
        </div>
        <p class="meta">Jul 12, 2025 • Dr. Singh • Midtown Clinic</p>
        <p class="snippet">Discussed A1C and lipid panel. Lifestyle recommendations.</p>
        <a class="btn" href="../Patient_FE/patient.html?session=2025-07-12">View Summary</a>
      </article>

      <article class="card" data-date="2025-06-03" data-provider="PA Chen" data-notes="allergy consult">
        <div class="row">
          <h3 class="title">Allergy Consultation</h3>
          <span class="status done">Signed</span>
        </div>
        <p class="meta">Jun 3, 2025 • PA Yeasmin • Riverside Med</p>
        <p class="snippet">Seasonal allergies; prescribed antihistamine, nasal spray.</p>
        <a class="btn" href="../Patient_FE/patient.html?session=2025-06-03">View Summary</a>
      </article>

      <article class="card" data-date="2025-03-22" data-provider="Dr. Patel" data-notes="imaging referral">
        <div class="row">
          <h3 class="title">Orthopedic Visit</h3>
          <span class="status done">Signed</span>
        </div>
        <p class="meta">Mar 22, 2025 • Dr. Hayles • Ortho Group</p>
        <p class="snippet">Knee pain; imaging referral placed; PT exercises shared.</p>
        <a class="btn" href="../Patient_FE/patient.html?session=2025-03-22">View Summary</a>
      </article>
    </section>
  </main>

  <script>

    const search = document.getElementById('search');
    const chips = [...document.querySelectorAll('.chip')];
    const cards = [...document.querySelectorAll('.card')];

    const withinDays = (isoDate, days) => {
      if (days === 'all') return true;
      const then = new Date(isoDate);
      const now = new Date();
      const diff = (now - then) / (1000*60*60*24);
      return diff <= Number(days);
    };

    function applyFilters() {
      const term = search.value.trim().toLowerCase();
      const active = chips.find(c => c.classList.contains('active'));
      const range = active ? active.dataset.range : 'all';

      cards.forEach(card => {
        const hay = (card.dataset.provider + ' ' + card.dataset.notes + ' ' + card.querySelector('.title').textContent + ' ' + card.querySelector('.meta').textContent).toLowerCase();
        const matchesText = hay.includes(term);
        const matchesDate = withinDays(card.dataset.date, range);
        card.style.display = matchesText && matchesDate ? '' : 'none';
      });
    }

    search.addEventListener('input', applyFilters);
    chips.forEach(chip => chip.addEventListener('click', () => {
      chips.forEach(c => c.classList.remove('active'));
      chip.classList.add('active');
      applyFilters();
    }));

    // initial
    applyFilters();
  </script>
</body>
</html>
